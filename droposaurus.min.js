;(function(t,e){if(typeof define==="function"&&define.amd)define(["jquery","./../body-toucher/body-toucher","./../gush/gush"],e);else if(typeof exports==="object")module.exports=e(require("jquery"),require("./../body-toucher/body-toucher"),require("./../gush/gush"));else{e(t.jQuery)}})(this,function($,t,e,a){"use strict";$(function(){var t="catchDropdown",e={touchBody:true};function i(a,i){this.element=a;this.jqElem=$(a);this.options=$.extend({},e,i);this._defaults=e;this._name=t;if(!this.jqElem.is(".droposaurusised"))this.init()}i.prototype={init:function(){var t=this.jqElem,e=this;if(this.options.touchBody)$.addBody();t.each(function(){var t=$(this);if(t.prop("tagName")===a||t.prop("tagName").toUpperCase()!=="SELECT")return;var i=t.wrap('<div class="dropdown-wrapper'+(t.data("size")?" size"+t.data("size"):"")+'"></div>'),d=i.parent(),s=(i.attr("class")||"").replace("select-invisible",""),n='<label aria-hidden="true" class="'+(i.data("error ")?"error":"")+s+'"><span class="span-label'+(i.data("hideLabel")?" hidden":"")+'">'+(!i.data("mobile-only-label")&&i.data("label")||"")+"</span>"+'<div class="btn-dd">'+'<a href="" '+(i.data("sourceId")?'id="'+i.data("sourceId")+'"':"")+' class="input btn-dd-select phone-type icon-chevron-fat-down'+(i.attr("data-selected")?" populated":"")+'" tabindex="0">'+'<span class="main"'+(i.data("placeholder-color")?' style="color:'+i.data("placeholder-color")+'"':"")+">"+i.data("placeholder")+"</span>"+(i.data("subtext")?"<span class='sub'>"+i.data("subtext")+"</span>":"")+"</a>"+'<div class="btn-dd-options">'+'<div class="btn-dd-header">'+i.data("label")+' <a class="btn-dd-close">Close</a>'+"</div>"+"<ul></ul>"+"</div>"+"</div>"+"</label>";i.after(n);i.addClass("hidden");e.update();d.find("ul").gush({x:false,move:{stopPropagation:true}});$("html").click(function(t){d.find(".btn-dd").removeClass("active");$.scrollElem(true).removeClass("no-overflow")});var l=-1;$(document).on("keydown.dropasaur",function(t){if(t.keyCode==40){if(d.find(".btn-dd.active").length){t.preventDefault();var e=d.find(".btn-dd-option a");if(l<e.length-1){l++}var a=e[l];a.focus();i.find('option[value="'+$(a).data("value")+'"]').prop("selected",true);i.trigger("change");i.trigger("changeDrop",[$(a).data("value")])}}else if(t.keyCode==38){if(d.find(".btn-dd.active").length){t.preventDefault();var e=d.find(".btn-dd-option a");if(l>0){l--}var a=e[l];a.focus();i.find('option[value="'+$(a).data("value")+'"]').prop("selected",true);i.trigger("change");i.trigger("changeDrop",[$(a).data("value")])}}else if(t.keyCode==9){var s=d.find(".btn-dd.active");if(s.length){var n=i.find('option[value="'+i.val()+'"]');t.preventDefault();s.removeClass("active");$.scrollElem(true).removeClass("no-overflow");s.find("a").first().addClass("populated");s.find("a").first().focus();s.find("a .main").first().text(n.text());if(s.find("a .sub").length==0){s.find("a").append('<span class="sub"></span>')}s.find("a .sub").first().text(i.data("subtext")||n.data("subtext")||"")}}else if(t.keyCode==13){var s=d.find(".btn-dd.active");if(s.length){var n=i.find('option[value="'+i.val()+'"]');t.preventDefault();s.removeClass("active");$.scrollElem(true).removeClass("no-overflow");s.find("a").first().addClass("populated");s.find("a").first().focus();s.find("a .main").first().text(n.text());if(s.find("a .sub").length==0){s.find("a").append('<span class="sub"></span>')}s.find("a .sub").first().text(i.data("subtext")||n.data("subtext")||"")}}})});this.jqElem.addClass("droposaurusised")},update:function(t){var e=this.jqElem,i=this,d,s,n;e.each(function(){var e=$(this),i=e.closest(".dropdown-wrapper");if(typeof t=="object"){e.html("");for(n=0;n<t.length;n++){s=t[n];e.append('<option value="'+s.value+'" data-subtext="'+s.subtext+'">'+(s.innerHTML?s.innerHTML:s.value)+"<option>")}}else if(typeof t=="string"){e.html(t)}i.find("ul").html("");if(e.attr("allow-empty")=="true"||e.attr("data-allow-empty")=="true"){e.prepend('<option value=""></option>');i.find("ul").append('<li class="dd-empty-option input btn-dd-option catch-dropdown-item"><a class="catch-dropdown-link" href="" tabindex="-1" data-value=""></a></li>')}e.find("option").each(function(){var t=$(this),d=t.text(),s=t.attr("value")===a?"":t.attr("value"),n=e.attr("data-selected")===a?"":e.attr("data-selected");if(t.text()!=""){i.find("ul").append('<li class="input btn-dd-option catch-dropdown-item">'+'<a class="catch-dropdown-link'+(d=="Add Connection"?" btn--add btn--icon icon-add icon-after":"")+(n==s?" selected":"")+'" '+'href="" '+'tabindex="-1" '+'data-value="'+s+'">'+'<span class="main">'+d+"</span>"+(t.data("subtext")?'<span class="sub">'+t.data("subtext")+"</span>":"")+"</a>"+"</li>")}});if(e.attr("data-selected")===a){d=e.find("option[selected]");if(!d){e.find("option").each(function(){var t=$(this);if(t.prop("selected"))d=t})}if(!d.length)d=e.find('option[value="'+e.val()+'"]');if(!d.length)d=e.find("option").first()}else{d=e.find('option[value="'+e.attr("data-selected")+'"]');if(!d.length){e.find("option").each(function(){var t=$(this).attr("value")===a?"":$(this).attr("value");if(e.attr("data-selected")==t)d=$(this)})}}d.prop("selected",true);e.trigger("change");i.find(".btn-dd-select .main").first().text(d.text()||e.data("placeholder")||"");if(i.find(".btn-dd-select .sub").length==0){i.find(".btn-dd-select").append('<span class="sub"></span>')}i.find(".btn-dd-select .sub").first().text(e.data("subtext")||d.data("subtext")||"");i.find(".btn-dd").off("click.dropasaur").on("click.dropasaur",function(t){t.preventDefault();t.stopPropagation();if($(this).hasClass("disabled")){return}if(!$(this).hasClass("active")){$(".btn-dd").removeClass("active")}e.trigger("probable_change");var a=e.val();$(this).find("li a").each(function(){$(this).toggleClass("selected",a==$(this).data("value"))});$(this).toggleClass("active");$.scrollElem(true).toggleClass("no-overflow");$(this).find("a").first().addClass("populated")});i.find("li a").off("click.dropasaur").on("click.dropasaur",function(t){t.preventDefault();t.stopPropagation();var a=e.find('option[value="'+$(this).data("value")+'"]').prop("selected",true);i.find(".btn-dd-select .main").first().text($(this).find(".main").text());if(i.find(".btn-dd-select .sub").length==0){i.find(".btn-dd-select").append('<span class="sub"></span>')}i.find(".btn-dd-select .sub").first().text(e.data("subtext")||a.data("subtext")||"");e.trigger("change");$.scrollElem(true).removeClass("no-overflow");i.find(".btn-dd").toggleClass("active").find("a").first().addClass("populated")})})},setDisabled:function(t){this.jqElem.parent().find(".btn-dd").toggleClass("disabled",t)}};$.fn[t]=function(e,a){return this.each(function(){if(!$.data(this,"plugin_"+t)){$.data(this,"plugin_"+t,new i(this,e))}else if(e=="update"){$.data(this,"plugin_"+t).update(a)}else if(e=="setDisabled"){$.data(this,"plugin_"+t).setDisabled(a)}})}})});
