;(function(e,t){if(typeof define==="function"&&define.amd)define(["jquery","./../body-toucher/body-toucher","./../gush/gush"],t);else if(typeof exports==="object")module.exports=t(require("jquery"),require("./../body-toucher/body-toucher"),require("./../gush/gush"));else{t(e.jQuery)}})(this,function($,e,t,a){"use strict";$(function(){var e="catchDropdown",t={touchBody:true,jsxHandling:false};function s(a,s){this.element=a;this.jqElem=$(a);this.options=$.extend({},t,s);this._defaults=t;this._name=e;if(!this.jqElem.is(".droposaurusised"))this.init()}s.prototype={init:function(){var e=this.jqElem,t=this;if(this.options.touchBody)$.addBody();e.each(function(){var e=$(this);if(e.prop("tagName")===a||e.prop("tagName").toUpperCase()!=="SELECT")return;var s=e.wrap('<div class="dropdown-wrapper'+(e.data("size")?" size"+e.data("size"):"")+'"></div>'),i=s.parent(),d=s.attr("id")||s.attr("name")||null,n=s.data("sourceId")||d+"-dd",l=n.replace(/[^A-Za-z0-9]+/g,"-"),o=t.uid(l),r=t.uid(o+"-label"),c=(s.attr("class")||"").replace("select-invisible",""),u='<label id="'+r+'" aria-hidden="true" class="'+(s.data("error ")?"error":"")+c+'">'+'<span class="span-label'+(s.data("hideLabel")?" hidden":"")+'">'+(!s.data("mobile-only-label")&&s.data("label")||"")+"</span>"+'<div class="btn-dd">'+'<a href="" id="'+o+'" class="input btn-dd-select phone-type icon-chevron-fat-down'+(s.attr("data-selected")?" populated":"")+'" tabindex="0">'+'<span class="main"'+(s.data("placeholder-color")?' style="color:'+s.data("placeholder-color")+'"':"")+">"+s.data("placeholder")+"</span>"+(s.data("subtext")?"<span class='sub'>"+s.data("subtext")+"</span>":"")+"</a>"+'<div class="btn-dd-options">'+'<div class="btn-dd-header">'+s.data("label")+' <a class="btn-dd-close">Close</a>'+"</div>"+"<ul></ul>"+"</div>"+"</div>"+"</label>";s.after(u);s.addClass("hidden");t.update();i.find("ul").gush({x:false,move:{stopPropagation:true}});if($.listen)$.listen("parsley:field:error",function(t){if(t.$element.attr("name")==e.attr("name")){$("#"+r).addClass("error")}});$("html").click(function(e){i.find(".btn-dd").removeClass("active");$("html").removeClass("s-dd-active");$.scrollElem(true).removeClass("no-overflow")});var f=-1;$(document).on("keydown.droposaur",function(t){if(t.keyCode==40){if(i.find(".btn-dd.active").length){t.preventDefault();var a=i.find(".btn-dd-option a");if(f<a.length-1){f++}var d=a[f];d.focus();s.find('option[value="'+$(d).data("value")+'"]').prop("selected",true);s.trigger("change");s.trigger("changeDrop",[$(d).data("value")]);e.removeClass("error")}}else if(t.keyCode==38){if(i.find(".btn-dd.active").length){t.preventDefault();var a=i.find(".btn-dd-option a");if(f>0){f--}var d=a[f];d.focus();s.find('option[value="'+$(d).data("value")+'"]').prop("selected",true);s.trigger("change");s.trigger("changeDrop",[$(d).data("value")]);e.removeClass("error")}}else if(t.keyCode==9){var n=i.find(".btn-dd.active");if(n.length){var l=s.find('option[value="'+s.val()+'"]');t.preventDefault();n.removeClass("active");$("html").removeClass("s-dd-active");$.scrollElem(true).removeClass("no-overflow");n.find("a").first().addClass("populated");n.find("a").first().focus();n.find("a .main").first().text(l.text());if(n.find("a .sub").length==0){n.find("a").append('<span class="sub"></span>')}n.find("a .sub").first().text(s.data("subtext")||l.data("subtext")||"")}}else if(t.keyCode==13){var n=i.find(".btn-dd.active");if(n.length){var l=s.find('option[value="'+s.val()+'"]');t.preventDefault();n.removeClass("active");$("html").removeClass("s-dd-active");$.scrollElem(true).removeClass("no-overflow");n.find("a").first().addClass("populated");n.find("a").first().focus();n.find("a .main").first().text(l.text());if(n.find("a .sub").length==0){n.find("a").append('<span class="sub"></span>')}n.find("a .sub").first().text(s.data("subtext")||l.data("subtext")||"")}}})});this.jqElem.addClass("droposaurusised").trigger("droposaurusised")},uid:function(e){var t=2,a=e;while(!a||$("#"+a).length){a=e+t;t++}return a},update:function(e){var t=this.jqElem,s=this,i,d,n;t.each(function(){var t=$(this),l=t.closest(".dropdown-wrapper");if(typeof e=="object"){t.html("");for(n=0;n<e.length;n++){d=e[n];t.append('<option value="'+d.value+'" data-subtext="'+d.subtext+'">'+(d.innerHTML?d.innerHTML:d.value)+"<option>")}}else if(typeof e=="string"){t.html(e)}l.find("ul").html("");if(t.attr("allow-empty")=="true"||t.attr("data-allow-empty")=="true"){t.prepend('<option value=""></option>');l.find("ul").append('<li class="dd-empty-option input btn-dd-option catch-dropdown-item"><a class="catch-dropdown-link" href="" tabindex="-1" data-value=""></a></li>')}t.find("option").each(function(e){var i=$(this),d=i.text(),n=s.jqElem.attr("id")||s.jqElem.attr("name")||null,o=(n+"-"+i.val()+"-"+e).replace(/[^A-Za-z0-9]+/g,"-"),r=s.uid(o),c=s.uid(r+"-trigger"),u=i.attr("value")===a?"":i.attr("value"),f=t.attr("data-selected")===a?"":t.attr("data-selected");if(i.text()!=""){l.find("ul").append('<li id="'+r+'" '+'class="input btn-dd-option catch-dropdown-item">'+'<a class="catch-dropdown-link'+(d=="Add Connection"?" btn--add btn--icon icon-add icon-after":"")+(f==u?" selected":"")+'" '+'id="'+c+'"'+'href="" '+'tabindex="-1" '+'data-value="'+u+'">'+'<span class="main">'+d+"</span>"+(i.data("subtext")?'<span class="sub">'+i.data("subtext")+"</span>":"")+"</a>"+"</li>")}});if(t.attr("data-selected")===a){i=t.find("option[selected]");if(!i){t.find("option").each(function(){var e=$(this);if(e.prop("selected"))i=e})}if(!i.length)i=t.find('option[value="'+t.val()+'"]');if(!i.length)i=t.find("option").first()}else{i=t.find('option[value="'+t.attr("data-selected")+'"]');if(!i.length){t.find("option").each(function(){var e=$(this).attr("value")===a?"":$(this).attr("value");if(t.attr("data-selected")==e)i=$(this)})}}i.prop("selected",true);t.trigger("change");$(this).removeClass("error");l.find(".btn-dd-select .main").first().text(i.text()||t.data("placeholder")||"");if(l.find(".btn-dd-select .sub").length==0){l.find(".btn-dd-select").append('<span class="sub"></span>')}l.find(".btn-dd-select .sub").first().text(t.data("subtext")||i.data("subtext")||"");l.find(".btn-dd").off("click.droposaur").on("click.droposaur",function(e){e.preventDefault();e.stopPropagation();if($(this).hasClass("disabled")){return}if(!$(this).hasClass("active")){$(".btn-dd").removeClass("active")}t.trigger("probable_change");$(this).closest(".catch-dropdown").removeClass("error");var a=t.val();$(this).find("li a").each(function(){$(this).toggleClass("selected",a==$(this).data("value"))});$(this).toggleClass("active");$("html").toggleClass("s-dd-active");$.scrollElem(true).toggleClass("no-overflow");$(this).find("a").first().addClass("populated")});l.find("li a").off("click.droposaur").on("click.droposaur",function(e){e.preventDefault();e.stopPropagation();var a=t.find('option[value="'+$(this).data("value")+'"]').prop("selected",true);l.find(".btn-dd-select .main").first().text($(this).find(".main").text());if(l.find(".btn-dd-select .sub").length==0){l.find(".btn-dd-select").append('<span class="sub"></span>')}l.find(".btn-dd-select .sub").first().text(t.data("subtext")||a.data("subtext")||"");if(t.attr("data-droposaur-firenative")&&s.options.jsxHandling){var i="change",d=t[0],n;if(typeof window.CustomEvent==="function"){d.dispatchEvent(new Event(i,{bubbles:true,cancelable:true}))}else if(document.createEvent){n=document.createEvent("Event");n.initEvent(i,true,true);d.dispatchEvent(n)}else{n=document.createEventObject();d.fireEvent("on"+i,n)}}else{t.trigger("change")}$(this).closest(".catch-dropdown").removeClass("error");$("html").removeClass("s-dd-active");$.scrollElem(true).removeClass("no-overflow");l.find(".btn-dd").toggleClass("active").find("a").first().addClass("populated")})})},setDisabled:function(e){this.jqElem.parent().find(".btn-dd").toggleClass("disabled",e)}};$.fn[e]=function(t,a){return this.each(function(){if(!$.data(this,"plugin_"+e)){$.data(this,"plugin_"+e,new s(this,t))}else if(t=="update"){$.data(this,"plugin_"+e).update(a)}else if(t=="setDisabled"){$.data(this,"plugin_"+e).setDisabled(a)}})}})});
