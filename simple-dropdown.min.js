;(function(e,i){if(typeof define==="function"&&define.amd)define(["jquery","./../body-toucher/body-toucher","./../gush/gush"],i);else if(typeof exports==="object")module.exports=i(require("jquery"),require("./../body-toucher/body-toucher"),require("./../gush/gush"));else{i(e.jQuery)}})(this,function(l,e,i,t){"use strict";l(function(){var t="simpleDropdown",s={touchBody:true};function i(e,i){this.element=e;this.jqElem=l(e);this.options=l.extend({},s,i);this._defaults=s;this._name=t;if(!this.jqElem.is(".droposaurusised, .simple-dd-generated"))this.init()}i.prototype={uid:function(e){var i=2,t=e;while(!t||l("#"+t).length){t=e+i;i++}return t},init:function(){if(this.options.touchBody)l.addBody();var r=this,n=this.jqElem;n.each(function(){var s=l(this),e=s.find("ul"),i=e.parent(),t=e.detach(),o=r.uid(s.attr("data-id")||"dd"),a=i.offset().top+i.height()+l.scrollElem().scrollTop(),d=-1,f=false;l.scrollElem().append(t);t.wrap("<div "+'class="'+"simple-dd "+"simple-dd-generated "+(s.is(".pin-right")?"pin-right":"")+'" '+'id="'+o+'">'+"</div>");l(window).off("resize."+o).on("resize."+o,function(){var e={position:"absolute",top:i.offset().top+i.height()+l.scrollElem().scrollTop()};e["left"]=s.is(".pin-right")?i.offset().left-t.outerWidth()+i.outerWidth():e["left"]=i.offset().left;t.parent().css(e)}).trigger("resize");s.find("a").first().off("click.smpdd").on("click.smpdd",function(e){e.preventDefault();e.stopPropagation();d=-1;if(l("#"+o).hasClass("active")){l(".simple-dd").removeClass("active");n.removeClass("active");return}l(".simple-dd").removeClass("active");s.trigger("probable_change");l("#"+o).addClass("active");n.addClass("active");l(window).trigger("resize")});l("html").off("click.smpdd").on("click.smpdd",function(e){l(".simple-dd").removeClass("active")});l(document).off("keyup."+o).on("keyup."+o,function(e){if(e.keyCode==16)f=false});l(document).off("keydown."+o).on("keydown."+o,function(e){if(e.keyCode==16){f=true}else if(e.keyCode==40){if(l("#"+o).hasClass("active")){e.preventDefault();var i=l("#"+o).find("a");if(d<i.length-1){d++}var t=i[d];t.focus()}}else if(e.keyCode==9){if(l("#"+o).hasClass("active")){var i=l("#"+o).find("a");if(d<i.length-1&&!f){d++;var t=i[d];t.focus();e.preventDefault()}else if(f){if(d>0){d--;var t=i[d];t.focus()}else{d--;l(".simple-dd").removeClass("active");s.find("a").first().focus()}e.preventDefault()}else{d++;if(s.data("next")){l(s.data("next")).find("a").focus();l(".simple-dd").removeClass("active");e.preventDefault()}else{s.find("a").focus();l(".simple-dd").removeClass("active")}}}}else if(e.keyCode==38){if(l("#"+o).hasClass("active")){e.preventDefault();var i=l("#"+o).find("a");if(d>0){d--}var t=i[d];t.focus()}}else if(e.keyCode==27){if(l("#"+o).hasClass("active")){l(".simple-dd").removeClass("active")}}})});n.addClass("droposaurusised").trigger("droposaurusised")}};l.fn[t]=function(e){return this.each(function(){if(!l.data(this,"plugin_"+t)){l.data(this,"plugin_"+t,new i(this,e))}})}})});
