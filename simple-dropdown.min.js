;(function(e,i){if(typeof define==="function"&&define.amd)define(["jquery","./../body-toucher/body-toucher","./../gush/gush"],i);else if(typeof exports==="object")module.exports=i(require("jquery"),require("./../body-toucher/body-toucher"),require("./../gush/gush"));else{i(e.jQuery)}})(this,function($,e,i,t){"use strict";$(function(){var e="simpleDropdown",i={touchBody:true};function t(t,s){this.element=t;this.jqElem=$(t);this.options=$.extend({},i,s);this._defaults=i;this._name=e;if(!this.jqElem.is(".droposaurusised, .simple-dd-generated"))this.init()}t.prototype={uid:function(e){var i=2,t=e;while(!t||$("#"+t).length){t=e+i;i++}return t},init:function(){if(this.options.touchBody)$.addBody();var e=this,i=this.jqElem;i.each(function(){var t=$(this),s=t.find("ul"),o=s.parent(),a=s.detach(),d=e.uid(t.attr("data-id")||"dd"),f=o.offset().top+o.height()+$.scrollElem().scrollTop(),r=-1,n=false;$.scrollElem().append(a);a.wrap("<div "+'class="'+"simple-dd "+"simple-dd-generated "+(t.is(".pin-right")?"pin-right":"")+'" '+'id="'+d+'">'+"</div>");$(window).off("resize."+d).on("resize."+d,function(){var e={position:"absolute",top:o.offset().top+o.height()+$.scrollElem().scrollTop()};e["left"]=t.is(".pin-right")?o.offset().left-a.outerWidth()+o.outerWidth():e["left"]=o.offset().left;a.parent().css(e)}).trigger("resize");t.find("a").first().off("click.smpdd").on("click.smpdd",function(e){e.preventDefault();e.stopPropagation();r=-1;if($("#"+d).hasClass("active")){$(".simple-dd").removeClass("active");i.removeClass("active");return}$(".simple-dd").removeClass("active");t.trigger("probable_change");$("#"+d).addClass("active");i.addClass("active");$(window).trigger("resize")});$("html").off("click.smpdd").on("click.smpdd",function(e){$(".simple-dd").removeClass("active")});$(document).off("keyup."+d).on("keyup."+d,function(e){if(e.keyCode==16)n=false});$(document).off("keydown."+d).on("keydown."+d,function(e){if(e.keyCode==16){n=true}else if(e.keyCode==40){if($("#"+d).hasClass("active")){e.preventDefault();var i=$("#"+d).find("a");if(r<i.length-1){r++}var s=i[r];s.focus()}}else if(e.keyCode==9){if($("#"+d).hasClass("active")){var i=$("#"+d).find("a");if(r<i.length-1&&!n){r++;var s=i[r];s.focus();e.preventDefault()}else if(n){if(r>0){r--;var s=i[r];s.focus()}else{r--;$(".simple-dd").removeClass("active");t.find("a").first().focus()}e.preventDefault()}else{r++;if(t.data("next")){$(t.data("next")).find("a").focus();$(".simple-dd").removeClass("active");e.preventDefault()}else{t.find("a").focus();$(".simple-dd").removeClass("active")}}}}else if(e.keyCode==38){if($("#"+d).hasClass("active")){e.preventDefault();var i=$("#"+d).find("a");if(r>0){r--}var s=i[r];s.focus()}}else if(e.keyCode==27){if($("#"+d).hasClass("active")){$(".simple-dd").removeClass("active")}}})});i.addClass("droposaurusised").trigger("droposaurusised")}};$.fn[e]=function(i){return this.each(function(){if(!$.data(this,"plugin_"+e)){$.data(this,"plugin_"+e,new t(this,i))}})}})});
